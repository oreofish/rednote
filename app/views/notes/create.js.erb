<%# encoding: utf-8 %>

(function() {
  <% if @note.valid?  %>
    var $notes = $('#notes_content ul.list');
    var id;

    $notes.prepend( "<%= j render :partial => 'notes/note', :locals => { :note => @note } %>" );

    id = "<%= attachmentKind(@note.kind) %>";
    $('#'+id).find('#new_note')[0].reset();
    if (id === "text") {
      if (CKEDITOR.instances["note_code"]) {
        CKEDITOR.instances["note_code"].setData('');
      }
    }
    $('#notes_content').find('ul.list div:first').hide().fadeIn(1000);
    commentsManager.bindCommentHandler(<%= @note.id %>);
    rednote.updateNoteTime();
  <% end %>
}());


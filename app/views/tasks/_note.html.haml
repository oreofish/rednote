- # encoding: utf-8 

%div{ :id => "task#{task.id}", :class => "red-note taskitem #{task_css(task)}"}
  %span.task-action
    - if task.assigned_to == nil
      = link_to "认领", assign_tasks_path(:taskid =>"task#{task.id}", :userid => "user#{current_user.id}"), :confirm => "确定认领这个任务?", :remote => true
      = link_to "编辑", "#edittask#{task.id}", 'data-toggle'=>"modal"
      = link_to "删除", task, :confirm => "确定删除吗?", :method => :delete if current_user == task.user
    - else
      = link_to image_tag(User.find(task.assigned_to).avatar_url(:small), :size => "24x24"), mytasks_tasks_path(:id => task.assigned_to)

      = link_to "完成", set_status_tasks_path(:id => task), :class => "btn", :remote => true

  = best_in_place task, :content, type: :textarea, :ok_button => '保存', :cancel_button => '取消', :activator => "#editcontent#{task.id}"
  %span(id="editcontent#{task.id}")= link_to "修改", "javascript:void(0)"
  %br
  %strong.task-estimate= best_in_place task, :estimate, :type => :select, :activator => "#editestimate#{task.id}", :nil => '0天', :collection => [[0, '请选择'], [0.5,'0.5天'], [1, '1天'], [1.5, '1.5天'], [2, '2天'], [3, '3天'], [4, '4天'], [5, '5天']]
  %span(id="editestimate#{task.id}")= link_to "修改", "javascript:void(0)"

  .taskeditview.modal.hide.fade{:id => "edittask#{task.id}", :taskid => "#{task.id}", :style => "display: none;"}
    .modal-header
      %a.close(data-dismiss="modal") ×
      %h3 任务
    .modal-body
      .content
        %h3 Please waiting
      .comments
        = link_to "评论", index_task_comments_path(:task_id => task.id), :remote => true, :class => "small-link", :id => "comments_link#{task.id}","data-toggle" => "collapse", "data-target" => "#comments_list#{task.id}"
        .collapse.fade(style="height: 0px;" id="comments_list#{task.id}")
    .modal-footer
      %a.btn{:href => "close", "data-dismiss" => "modal"} 关闭



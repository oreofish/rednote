<%# encoding: utf-8 %>

<div class="well">

  <div class="row">
  <div id="note_publish" class="well span8">
    <legend class="title">写一条笔记</legend>
    <div class="tabbable">
      <ul class="nav nav-pills">
        <li><%= link_to "消息", "#message", "data-toggle" => "pill", "data-target" => "#message"%></li>
        <li><%= link_to "图片", "#image",   "data-toggle" => "pill", "data-target" => "#image"%></li>
        <li><%= link_to "链接", "#link",    "data-toggle" => "pill", "data-target" => "#link"%></li>
        <li><%= link_to "书籍", "#book",    "data-toggle" => "pill", "data-target" => "#book"%></li>
        <li><%= link_to "代码", "#code",    "data-toggle" => "pill", "data-target" => "#code"%></li>
        <li><%= link_to "文本", "#text",    "data-toggle" => "pill", "data-target" => "#text"%></li>
      </ul>

      <div id="attachment_block" class="tab-content row-fluid">
        <% attaches = ["message", "text", "link", "image", "code", "book" ] %>
        <% attaches.each_index do |idx| %>
          <div class="tab-pane fade <%= 'in active' if attaches[idx] == 'message' %>" id="<%= attaches[idx] %>">
            <%= form_for(@note, :html => { :multipart => true, :remote => true }) do |f| %>
              <%= f.text_area :summary, :rows => 4, "placeholder" => "写点什么", :class => "span12" %>

              <%= f.hidden_field :kind, :value => idx %>
              <% case attaches[idx] %>
              <% when "message" %>
                <!-- stub --> 
              <% when "image" %>
                <div class="control-group">
                  <%= f.label "上传图片：", :class=>"control-label", :for => "note_upload" %>
                  <div class="controls">
                    <%= f.file_field :upload, :class=>"input-file" %>
                  </div>
                </div>

              <% when "link" %>
                <div class="control-group">
                  <%= f.label "链接：", :class=>"control-label", :for => "note_description" %>
                  <div class="controls">
                    <%= f.text_field :description, :class => "span6" %>
                  </div>
                </div>

              <% when "book" %>
                <label>上传书籍：</label>  
                <%= f.file_field :upload %>

              <% when "code" %>
                <div class="control-group">
                  <label class="control-label">代码片段</label>
                  <div class="controls">
                    <%= f.text_area :description, :rows => 8, :class => "span8" %>
                  </div>
                </div>

                <div class="control-group"> 
                  <label class="control-label">选择语言</label>
                  <div class="controls">
                    <select id="language_id" name="language[id]"><option value="C">C</option> 
                      <option value="Clojure">Clojure</option> 
                      <option value="CSS">CSS</option> 
                      <option value="Delphi">Delphi</option> 
                      <option value="DIFF">DIFF</option> 
                      <option value="ERB">ERB</option> 
                      <option value="Groovy">Groovy</option> 
                      <option value="HAML">HAML</option> 
                      <option value="HTML">HTML</option> 
                      <option value="Java">Java</option> 
                      <option value="JavaScript">JavaScript</option> 
                      <option value="JSON">JSON</option> 
                      <option value="PHP">PHP</option> 
                      <option value="Python">Python</option> 
                      <option value="Ruby">Ruby</option> 
                      <option value="SQL">SQL</option> 
                      <option value="XML">XML</option> 
                      <option value="YAML">YAML</option> 
                    </select> 
                  </div>
                </div>

              <% when "text" %>
                <%#<%= f.text_area :description %>
                <textarea cols="40" id="note_code" name="note[description]" rows="8">
                </textarea> 
                <script type="text/javascript"> 
                  if (CKEDITOR.instances["note_code"]) { 
                    CKEDITOR.remove(CKEDITOR.instances["note_code"]); 
                  } 
                  CKEDITOR.replace("note_code", { "language":"en", "customConfig":"/ckeditor_config.js" }); 
                </script> 

              <% end %> <%# case end %>

              <button type="submit" class="btn btn-large btn-primary pull-right">
                <i class="icon-upload"></i> 发布
              </button>    
            <% end %>  <%# form_for end %>
          </div>
      <% end %> <%# each end %>
      
      </div> <%# attachment_block end %>
    </div>
  </div>
  </div>

  <div class="flash"></div>
  <div id="notes_content" class="row">
    <div class="well span8">
      <ul class="list unstyled">
        <%= render "list" %>
      </ul>

      <!-- pager loading hinter -->
      <div class="inner" id="pager_loading">
      </div>
    </div>

  </div> <!-- notes_content -->

</div>
